<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>S–F Tier Ranking</title>
  <link rel="icon" type="image/png" href="favicon.png">
  <link rel="stylesheet" href="default.css">
    <link rel="apple-touch-icon" sizes="180x180" href="favicon.png">
        <meta name="apple-mobile-web-app-title" content="Blue Flash">


  <style>
        #editCategories{
      position:absolute;
      top:20px;
      right:20px;
      padding:8px 12px;
      background:#0af;
      border:none;
      border-radius:8px;
      cursor:pointer;
      font-weight:bold;
      transition:.2s;
    }
    #editCategories:hover{
      background:rgba(0, 170, 255, 0.724);
    }
#editform {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: #222;
      padding: 20px;
      border: 2px solid #0af;
      border-radius: 12px;
      z-index: 1000;
}
#saveCategories, #cancelEdit {
      padding: 8px 12px;
      margin-top: 10px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
}
.card.center{
  margin:30px auto;
  display:block;
}

.tiers{
  display:grid;
  grid-template-columns:1fr;
  gap:14px;
  width:90%;
  max-width:1000px;
  margin:40px auto;
}

.tier{
  display:flex;
  align-items:flex-start;
  gap:16px;
  background:#1a1a1a;
  border:2px solid #444;
  border-radius:12px;
  padding:12px;
  transition:.2s;
}

.tier.full{
  opacity:.4;
}

.tier-header{
  width:80px;
  text-align:center;
}

.tier-label{
  font-size:26px;
  font-weight:bold;
}

.tier-count{
  font-size:13px;
  color:#aaa;
  margin-top:4px;
}

.tier-cards{
  display:flex;
  gap:12px;
  flex-wrap:wrap;
}

.tier-card{
  width:110px;
  padding:8px;
  background:#1a1a1a;
  border:2px solid #444;
  border-radius:12px;
  cursor:default;
}

.tier-card img{
  width:100%;
  height:140px;
  object-fit:contain;
  background:#000;
  border-radius:8px;
}

.tier-card p{
  margin:6px 0 0;
  font-size:13px;
  font-weight:bold;
}
.tier-card{
  width:120px;
  cursor:default;
}

.tier-card img{
  width:100%;
  height:160px;
  object-fit:contain;
  background:#000;
  border-radius:10px;
}

.tier-card p{
  margin:6px 0 0;
  font-size:14px;
  font-weight:bold;
}


  </style>
</head>

<body>

<div id="helpWrapper">
  <button id="helpBtn">?</button>
  <div id="helpTooltip">
    <strong>How to Play</strong><br><br>
    • You will be shown people one at a time.<br>
    • Assign each person to a tier (S–F).<br>
    • Each tier has limited slots.<br>
    • Once a tier is full, it cannot be used.
  </div>
</div>


<div id="editform">
  <h2>Edit Categories</h2>
  <label>S:</label><br>
  <input type="number" id="editS" style="width:100%;"><br><br>
  <label>A:</label><br>
  <input type="number" id="editA" style="width:100%;"><br><br>
  <label>B:</label><br>
  <input type="number" id="editB" style="width:100%;"><br><br>
  <label>C:</label><br>
  <input type="number" id="editC" style="width:100%;"><br><br>
  <label>D:</label><br>
  <input type="number" id="editD" style="width:100%;"><br><br>
  <label>F:</label><br>
  <input type="number" id="editF" style="width:100%;"><br><br>
  <button id="saveCategories">CONFIRM</button>
  <button id="cancelEdit">CANCEL</button>
</div>

<h1>S–F Tier Ranking</h1>
<button id="editCategories">EDIT</button>

<div class="navLinks"></div>

<br><br>

<div class="mode-toggle">
  <div class="select-wrap">
    <select class="dropdown" data-role="single"></select>
  </div>
</div>

<div id="game">
  <div class="card center" id="cardToRank">

    <img id="celeb-img" src="" alt="" draggable="false">
    <p id="celeb-name">Loading...</p>
  </div>

  <div class="tiers" id="tiers"></div>
</div>

<script src="default.js"></script>
<script>
let items = [];
let index = 0;

const tierLimits = {
  S: 1,
  A: 2,
  B: 3,
  C: 4,
  D: 5,
  F: 6
};
let total = 21;

const tiers = {
  S: [],
  A: [],
  B: [],
  C: [],
  D: [],
  F: []
};

const img = document.getElementById("celeb-img");
const nameEl = document.getElementById("celeb-name");
const tiersEl = document.getElementById("tiers");

function startGame(){
  index = 0;
  resetTiers();

  const pool = getPeople(gender);

  items = Object.entries(pool)
    .map(([name, img]) => ({ name, img }))
    .sort(() => Math.random() - 0.5)
    .slice(0, total);

  renderTiers();      // ✅ MUST happen before showNext
  updateTierStates(); // ✅ initialize counters
  showNext();
}


function showNext(){
  if(index >= items.length){
    nameEl.textContent = "Tier Ranking Complete!";
    img.style.display = "none";
    return;
  }

  const item = items[index];
  nameEl.textContent = item.name;

  if(item.img){
    img.src = item.img;
    img.style.display = "block";
  } else {
    img.style.display = "none";
  }

  updateTierStates();
}

function renderTiers(){
  tiersEl.innerHTML = "";

  Object.keys(tiers).forEach(tier => {
    const row = document.createElement("div");
    row.className = "tier";
    row.dataset.tier = tier;

    row.innerHTML = `
      <div class="tier-header">
        <div class="tier-label">${tier}</div>
        <div class="tier-count" id="count-${tier}"></div>
      </div>
      <div class="tier-cards"></div>
    `;

    row.addEventListener("click", () => assignTier(tier));
    tiersEl.appendChild(row);
  });

  updateTierStates();
}


function assignTier(tier){
  if(index >= items.length) return;
  if(tiers[tier].length >= tierLimits[tier]) return;

  const item = items[index];
  tiers[tier].push(item);

  const row = document.querySelector(
    `.tier[data-tier="${tier}"] .tier-cards`
  );

  const card = document.createElement("div");
  card.className = "card tier-card";

  card.innerHTML = `
    <img src="${item.img}" draggable="false">
    <p>${item.name}</p>
  `;

  row.appendChild(card);

  index++;
  showNext();
}


function updateTierStates(){
  document.querySelectorAll(".tier").forEach(row => {
    const tier = row.dataset.tier;
    const used = tiers[tier].length;
    const max = tierLimits[tier];

    const label = max === Infinity
      ? `${used} placed`
      : `${used} / ${max}`;

    document.getElementById(`count-${tier}`).textContent = label;

    row.classList.toggle("full", used >= max);
  });
}


function resetTiers(){
  for(const t in tiers){
    tiers[t] = [];
  }
  tiersEl.innerHTML = "";
}

document.getElementById("editCategories").onclick = () => {
  document.getElementById("editform").style.display = "block";
};

document.getElementById("saveCategories").onclick = () => {
  const s = document.getElementById("editS").value || 1;
  const a = document.getElementById("editA").value || 2;
  const b = document.getElementById("editB").value || 3;
  const c = document.getElementById("editC").value || 4;
  const d = document.getElementById("editD").value || 5;
  const f = document.getElementById("editF").value || 6;

  tierLimits.S = parseInt(s);
  tierLimits.A = parseInt(a);
  tierLimits.B = parseInt(b);
  tierLimits.C = parseInt(c);
  tierLimits.D = parseInt(d);
  tierLimits.F = parseInt(f);

  total = Object.values(tierLimits).reduce((sum, n) => sum + n, 0);

  document.getElementById("editform").style.display = "none";

  renderTiers();
  startGame();
};

document.getElementById("cancelEdit").onclick = () => {
  document.getElementById("editform").style.display = "none";
};

loadPeopleData(startGame);
</script>

</body>
</html>
