<!DOCTYPE html>
<html lang="en">
<head>


<meta charset="UTF-8">
<title>Draft Pick</title>

<link rel="icon" type="image/png" href="favicon.png">
<link rel="stylesheet" href="default.css">
    <link rel="apple-touch-icon" sizes="180x180" href="favicon.png">
    <meta name="apple-mobile-web-app-title" content="Blue Flash">


<style>
.board{
  display:flex;
  justify-content:center;
  gap:12px;
  padding:15px;
  border-top:1px solid #222;
}

.cards{
  display:flex;
  justify-content:center;
  gap:30px;
  margin:30px 0;
}

.slot{
  width:210px;
  height:330px;
  border-radius:14px;
  background:rgba(28,28,28,.35);
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  transition:.2s;
}

.slot.filled{
  opacity:1;
}

.slot img{
  width:100%;
  height:80%;
  object-fit:cover;
}

.slot-name{
  font-size:.75rem;
  padding:6px;
}

.end{
  display:none;
  padding:30px;
  text-align:center;
}
</style>
<link rel="stylesheet" href="mobile.css">
</head>

<body>

<div id="helpWrapper">
  <button id="helpBtn">?</button>
  <div id="helpTooltip">
    <strong>How to Play</strong><br><br>
    • Each round, you will be shown two people<br>
    • Click who you want to keep<br>
    • The other is gone forever<br>
    • 5 rounds total
  </div>
</div>

<h1>Draft Pick</h1>

<div class="navLinks"></div>

<br><br>

<div class="mode-toggle">
  <div class="select-wrap">
    <select class="dropdown" data-role="single"></select>
  </div>
</div>

<h2 id="roundText">Round 1 of 5</h2>

<div class="cards" id="cards"></div>

<div class="board" id="board"></div>

<!--<div id="finalBoard"></div>-->

<script src="default.js"></script>
<script>
/* ================= CONFIG ================= */
const TOTAL_ROUNDS = 5;

/* ================= STATE ================= */
let pool = [];
let round = 1;
let picks = [];

/* ================= DOM ================= */
const cardsEl = document.getElementById("cards");
const boardEl = document.getElementById("board");
const roundText = document.getElementById("roundText");
//const finalBoard = document.getElementById("finalBoard");

/* ================= RESET ================= */
function resetGameState(){
  round = 1;
  picks = [];

  cardsEl.innerHTML = "";
  boardEl.innerHTML = "";
  //finalBoard.innerHTML = "";

  cardsEl.style.display = "flex";
  roundText.style.display = "block";
}


/* ================= START ================= */
function startGame(){
  pool = Object.entries(getPeople(gender))
    .map(([name, img]) => ({ name, img }))
    .sort(() => Math.random() - 0.5);

  if(pool.length < TOTAL_ROUNDS * 2){
    alert("Not enough people in this category.");
    return;
  }

  resetGameState();
  initBoard();
  renderRound();
}

/* ================= BOARD ================= */
function initBoard(){
  for(let i = 0; i < TOTAL_ROUNDS; i++){
    const slot = document.createElement("div");
    slot.className = "slot";
    slot.textContent = i + 1;
    boardEl.appendChild(slot);
  }
}

/* ================= ROUND ================= */
function renderRound(){
  roundText.textContent = `Round ${round} of ${TOTAL_ROUNDS}`;
  cardsEl.innerHTML = "";

  const choices = pool.splice(0, 2);

  choices.forEach(person=>{
    const card = document.createElement("div");
    card.className = "card hoverable";
    card.innerHTML = `
      ${person.img ? `<img src="${person.img}" draggable="false">` : ""}
      <p>${person.name}</p>
    `;
    card.onclick = ()=>pick(person);
    cardsEl.appendChild(card);
  });
}

/* ================= PICK ================= */
function pick(person){
  picks.push(person);

  const slot = boardEl.children[picks.length - 1];
  slot.classList.add("filled");
  slot.innerHTML = `
    ${person.img ? `<img src="${person.img}">` : ""}
    <div class="slot-name">${person.name}</div>
  `;

  if(round === TOTAL_ROUNDS){
    endGame();
  } else {
    round++;
    renderRound();
  }
}

/* ================= END ================= */
function endGame(){
  cardsEl.style.display = "none";
  roundText.style.display = "none";
  //finalBoard.innerHTML = boardEl.innerHTML;
}

/* ================= INIT ================= */
document.addEventListener("DOMContentLoaded", () => {
  loadPeopleData(startGame);
});
</script>

</body>
</html>
