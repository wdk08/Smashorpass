<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="stylesheet" href="mobile.css">

  <meta charset="UTF-8">
  <title>Choose a Room</title>
  <link rel="icon" type="image/png" href="favicon.png">
  <link rel="stylesheet" href="default.css">
      <link rel="apple-touch-icon" sizes="180x180" href="favicon.png">
    <meta name="apple-mobile-web-app-title" content="Blue Flash">

  <style>
    .rooms{
      display:grid;
      grid-template-columns:repeat(3,1fr);
      gap:24px;
      width:90%;
      max-width:1100px;
      margin:40px auto;
    }

    .room{
      background:#1a1a1a;
      border:2px solid #444;
      border-radius:14px;
      padding:16px;
      cursor:pointer;
      transition:.2s;
      display:flex;
      flex-direction:column;
      gap:12px;
    }

    .room:hover{
      transform:translateY(-4px);
      border-color:#3cff9a;
    }

    .room-title{
      text-align:center;
      font-size:18px;
      font-weight:bold;
      opacity:.85;
    }

    .room-cards{
      display:flex;
      justify-content:center;
      gap:10px;
      flex-wrap:wrap;
    }

    .room .card{
      width:95px;
      padding:8px;
    }

    .room .card img{
      height:110px;
      object-fit:contain;
      background:#000;
      border-radius:8px;
    }

    .room .card p{
      font-size:12px;
      margin-top:4px;
      text-align:center;
    }

    .discarded{
      opacity:.25;
      pointer-events:none;
    }
  </style>
</head>

<body>

<div id="helpWrapper">
  <button id="helpBtn">?</button>
  <div id="helpTooltip">
    <strong>How to Play</strong><br><br>
    • You will be shown 3 rooms.<br>
    • Each room contains 3 people.<br>
    • Choose ONE room to keep.<br>
    • The other two rooms are discarded forever.<br>
    • Play continues until no full rooms remain.
  </div>
</div>

<h1>Choose a Room</h1>

<div class="navLinks"></div>

<br><br>

<div class="mode-toggle">
  <div class="select-wrap">
    <select class="dropdown" data-role="single"></select>
  </div>
</div>

<div id="game">
  <div class="rooms" id="rooms"></div>
</div>

<script src="default.js"></script>
<script src="default.js"></script>
<script>
let pool = [];

const roomsEl = document.getElementById("rooms");

function startGame(){
  roomsEl.innerHTML = "";

  const people = getPeople(gender);

  pool = Object.entries(people)
    .map(([name, img]) => ({ name, img }))
    .sort(() => Math.random() - 0.5);

  nextRound();
}

function nextRound(){
  roomsEl.innerHTML = "";

  if(pool.length < 9){
    roomsEl.innerHTML = `
      <h2 style="text-align:center;width:100%">
        Game Complete
      </h2>
    `;
    return;
  }

  // permanently consume 9 people
  const roundPeople = pool.splice(0, 9);

  const rooms = [
    roundPeople.slice(0, 3),
    roundPeople.slice(3, 6),
    roundPeople.slice(6, 9)
  ];

  rooms.forEach((people, i) => {
    const room = document.createElement("div");
    room.className = "room";

    room.innerHTML = `
      <div class="room-title">Room ${i + 1}</div>
      <div class="room-cards"></div>
    `;

    const cardsEl = room.querySelector(".room-cards");

    people.forEach(p => {
      const card = document.createElement("div");
      card.className = "card";

      card.innerHTML = `
        ${p.img ? `<img src="${p.img}" draggable="false">` : ""}
        <p>${p.name}</p>
      `;

      cardsEl.appendChild(card);
    });

    room.onclick = () => chooseRoom(room);
    roomsEl.appendChild(room);
  });
}

function chooseRoom(selectedRoom){
  document.querySelectorAll(".room").forEach(r => {
    if(r !== selectedRoom){
      r.classList.add("discarded");
    }
  });

  setTimeout(nextRound, 450);
}

loadPeopleData(startGame);
</script>


</body>
</html>
