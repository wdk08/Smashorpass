<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>King of the Hill</title>

  <!-- SHARED STYLES -->
  <link rel="stylesheet" href="default.css">

  <!-- PAGE-SPECIFIC STYLES -->
  <style>
    .choices{
      display:flex;
      justify-content:center;
      gap:50px;
      margin-top:40px;
      flex-wrap:wrap;
    }

    .winner{
      margin-top:30px;
    }

    .winner img{
      width:320px;
      border-radius:14px;
      background:#000;
    }
  </style>
</head>

<body>

<h1>King of the Hill</h1>

<!-- NAV -->
  <a href="index.html">Smash or Pass</a>
  <a href="kmk.html">Kiss Marry Kill</a>
  <a href="goc.html">Girl or Car</a>
  <a href="blind.html">Blind Ranking</a>
  <a href="wyw.html">King of the Hill</a>
  <a href="chaos.html">Infinity War</a>
  <a href="fb.html">Football Lineup</a>
  <a href="draft.html">Roster</a>
<br><br>

<!-- GENDER TOGGLE (DEFAULT SYSTEM) -->
<div class="mode-toggle">
  <button id="femaleBtn" class="active">‚ôÄ Female</button>
  <button id="maleBtn">‚ôÇ Male</button>
</div>


<!-- GAME -->
<div class="choices" id="choices"></div>

<script src="default.js"></script>
<script>
let allData = {};
let pool = [];
let eliminated = [];
let currentChampion = null;
let challenger = null;

/* ---------- INIT ---------- */

fetch("people.json")
  .then(res => res.json())
  .then(data => {
    allData = data;
    startGame();
  });

/* ---------- GAME ---------- */

function startGame(){
  if(!allData[gender]) return;

  pool = shuffle(
    Object.entries(allData[gender]).map(([name, img]) => ({
      name,
      img
    }))
  );

  eliminated = [];
  currentChampion = pool.shift();
  challenger = pool.shift();

  renderChoices(); // üî• THIS WAS MISSING
}


function shuffle(arr){
  for(let i = arr.length - 1; i > 0; i--){
    const j = Math.floor(Math.random() * (i + 1));
    [arr[i], arr[j]] = [arr[j], arr[i]];
  }
  return arr;
}

/* ---------- RENDER ---------- */

function renderChoices(){
  const choicesDiv = document.getElementById("choices");
  choicesDiv.innerHTML = "";

if(!currentChampion){
  return;
}

if(!challenger){
  showWinner();
  return;
}



  [currentChampion, challenger].forEach((item, index) => {
    const card = document.createElement("div");
    card.className = "card hoverable";
    card.innerHTML = `
      ${item.img ? `<img src="${item.img}" draggable="false">` : ""}
      <p>${item.name}</p>
    `;
    card.onclick = () => choose(index);
    choicesDiv.appendChild(card);
  });
}

/* ---------- LOGIC ---------- */

function choose(index){
  const winner = index === 0 ? currentChampion : challenger;
  const loser  = index === 0 ? challenger : currentChampion;

  eliminated.push(loser);
  currentChampion = winner;

  if(pool.length === 0){
    showWinner();
    return;
  }

  challenger = pool.shift();
  renderChoices();
}

/* ---------- END ---------- */

function showWinner(){
  const choicesDiv = document.getElementById("choices");
  choicesDiv.innerHTML = `
    <div class="winner">
      <h2>Winner üèÜ</h2>
      ${currentChampion.img ? `<img src="${currentChampion.img}">` : ""}
      <h3>${currentChampion.name}</h3>
      <p>Defeated ${eliminated.length} others</p>
    </div>
  `;
}

</script>

</body>
</html>
