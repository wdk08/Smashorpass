<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Girl ‚ù§Ô∏è or Car üöó</title>
<style>
body {
  background: #111;
  color: #fff;
  font-family: sans-serif;
  text-align: center;
  padding: 20px;
}
.choices {
  display: flex;
  justify-content: center;
  gap: 50px;
  margin-top: 50px;
  flex-wrap: wrap;
}
.choice {
  width: 250px;
  border: 2px solid white;
  border-radius: 10px;
  padding: 10px;
  cursor: pointer;
  background: #1a1a1a;
  transition: transform 0.2s;
}
.choice img {
  width: 100%;
  height: 300px;
  object-fit: cover;
  border-radius: 10px;
}
.choice:hover {
  transform: scale(1.05);
  border-color: #0af;
}
</style>
</head>
<body>
<h1>Girl ‚ù§Ô∏è or Car üöó</h1>
<a href="index.html">Play Smash or Pass</a><br>
<a href="kmk.html">Play Kiss, Marry, Kill</a><Br>
<input type="file" id="girlsUpload" accept=".json" />

<div class="choices" id="choices"></div>

<script>
const girlsUpload = document.getElementById('girlsUpload');

girlsUpload.addEventListener('change', (e) => {
  const file = e.target.files[0];
  if (!file) return;

  const reader = new FileReader();
  reader.onload = (event) => {
    try {
      let data = JSON.parse(event.target.result);

      if (data.Female && data.Male) {
        // Gendered structure
        girls = data.Female;
      } else if (Array.isArray(data)) {
        // Array of names: turn into { name: "" }
        let obj = {};
        data.forEach(name => obj[name] = ""); // empty string for image placeholder
        girls = obj;
      } else if (typeof data === "object") {
        // Flat object with URLs
        girls = data;
      } else {
        throw new Error("Invalid JSON format");
      }

      // Reset and start a new game with uploaded data
      results = [];
      nextPair();
    } catch (err) {
      console.error("Failed to parse uploaded JSON:", err);
      alert("Invalid JSON format. Use array or object format.");
    }
  };
  reader.readAsText(file);
});
</script>

<script>
let girls = {};
let cars = {};
let results = [];
const choicesDiv = document.getElementById('choices');

// Load JSON (girls.json and cars.json)
Promise.all([
  fetch('people.json').then(r=>r.json()),
  fetch('cars.json').then(r=>r.json())
]).then(([gData, cData]) => {
  // Detect gendered JSON
  if (gData.Female && gData.Male) {
    girls = gData.Female; // only use Female
  } else {
    girls = gData; // flat structure
  }
  cars = cData;
  nextPair();
}).catch(err => console.error("Failed to load JSON:", err));

function nextPair() {
  const girlNames = Object.keys(girls);
  const carNames = Object.keys(cars);

  if (girlNames.length === 0 || carNames.length === 0) {
    showResults();
    return;
  }

  // Pick random girl and car
  const girl = girlNames[Math.floor(Math.random() * girlNames.length)];
  const car = carNames[Math.floor(Math.random() * carNames.length)];

  const girlImg = girls[girl];
  const carImg = cars[car];

  // Remove them from pool
  delete girls[girl];
  delete cars[car];

  choicesDiv.innerHTML = '';
  choicesDiv.appendChild(createChoiceDiv(girl, girlImg, 'Girl'));
  choicesDiv.appendChild(createChoiceDiv(car, carImg, 'Car'));
}

function createChoiceDiv(name, img, type) {
  const div = document.createElement('div');
  div.className = 'choice';

  // Check if there's an image
  if (img) {
    div.innerHTML = `<img src="${img}" alt="${name}"><p>${name}</p>`;
  } else {
    div.innerHTML = `<p style="margin: 100px 0; font-size: 1.2em;">${name}</p>`;
    div.style.height = '150px'; // smaller height
    div.style.width = '180px';  // smaller width
    div.style.display = 'flex';
    div.style.justifyContent = 'center';
    div.style.alignItems = 'center';
    div.style.fontWeight = 'bold';
    div.style.fontSize = '1.2em';
    div.style.border = '2px solid #fff';
  }

  div.addEventListener('click', () => {
    results.push({ chosen: name, type: type });
    nextPair();
  });

  return div;
}


function showResults() {
  document.body.innerHTML = '<h2>Game Over</h2><h3>Your Choices:</h3>';
  results.forEach((r, i) => {
    document.body.innerHTML += `<p>Round ${i+1}: ${r.chosen} (${r.type})</p>`;
  });
}
</script>
</body>
</html>
