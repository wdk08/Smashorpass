<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="stylesheet" href="mobile.css">

<meta charset="UTF-8">
<title>Would You Rather</title>
<link rel="icon" type="image/png" href="favicon.png">
<link rel="stylesheet" href="default.css">
    <link rel="apple-touch-icon" sizes="180x180" href="favicon.png">
    <meta name="apple-mobile-web-app-title" content="Blue Flash">


<style>
.choices {
  display: flex;
  justify-content: center;
  gap: 50px;
  margin-top: 50px;
  flex-wrap: wrap;
}
</style>
</head>
<body>

<div id="helpWrapper">
  <button id="helpBtn">?</button>
  <div id="helpTooltip">
    <strong>How to Play</strong><br><br>
    • Each round, choose between the two options<br>
    • Your choices are saved in order
  </div>
</div>

<h1>Would You Rather</h1>

<div class="navLinks"></div>
<br><br>

<div class="mode-toggle">
  <div class="select-wrap">
    <select class="dropdown" data-role="left"></select>
  </div>

  <div class="select-wrap">
    <select class="dropdown" data-role="right"></select>
  </div>
</div>

<br><br>
<div class="choices"></div>

<script src="default.js"></script>

<script>
/* =========================
   GAME STATE
========================= */

let leftPool = {};
let rightPool = {};
let results = [];

const choices = document.querySelector(".choices");

/* =========================
   GAME START
========================= */

loadPeopleData(() => {
  startGame();
});

/* =========================
   START / RESET GAME
========================= */

function startGame() {
  results = [];

  leftPool  = { ...getPeople(leftCategory) };
  rightPool = { ...getPeople(rightCategory) };

  choices.innerHTML = "";
  nextPair();
}

/* =========================
   GAME LOOP
========================= */

function nextPair() {
  const leftKeys = Object.keys(leftPool);
  const rightKeys = Object.keys(rightPool);

  if (!leftKeys.length || !rightKeys.length) {
    showResults();
    return;
  }

  const leftName = randomPick(leftKeys);
  const rightName = randomPick(rightKeys);

  const leftImg = leftPool[leftName];
  const rightImg = rightPool[rightName];

  delete leftPool[leftName];
  delete rightPool[rightName];

  choices.innerHTML = "";

  choices.appendChild(createChoice(leftName, leftImg, leftCategory));
  choices.appendChild(createChoice(rightName, rightImg, rightCategory));
}

/* =========================
   CARD CREATION
========================= */

function createChoice(name, img, type) {
  const div = document.createElement("div");
  div.className = "card hoverable";

  div.innerHTML = img
    ? `<img src="${img}"><p>${name}</p>`
    : `<p style="margin:100px 0">${name}</p>`;

  div.onclick = () => {
    results.push({ chosen: name, type });
    nextPair();
  };

  return div;
}

/* =========================
   RESULTS
========================= */

function showResults() {
  choices.innerHTML = "";

  results.forEach((r, i) => {
    choices.innerHTML += `<p>${i + 1}. ${r.chosen} (${r.type})</p>`;
  });
}

/* =========================
   UTIL
========================= */

function randomPick(arr) {
  return arr[Math.floor(Math.random() * arr.length)];
}
</script>

</body>
</html>
