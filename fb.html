<!DOCTYPE html>
<html lang="en">
<head>


    <meta name="viewport" content="width=device-width, initial-scale=1.0">

<meta charset="UTF-8">
<title>Build the Lineup</title>

<link rel="icon" type="image/png" href="favicon.png">
<link rel="stylesheet" href="default.css">
    <link rel="apple-touch-icon" sizes="180x180" href="favicon.png">
    <meta name="apple-mobile-web-app-title" content="Blue Flash">


<style>
.field{
  max-width:900px;
  margin:40px auto;
  background:linear-gradient(#0b6623,#064e1a);
  border-radius:18px;
  padding:30px;
  border:3px solid #333;
}

.field-grid{
  display:grid;
  grid-template-columns:repeat(11,1fr);
  grid-template-rows:repeat(3,90px);
  gap:14px;
}

.slot{
  width:65px;
  height:90px;
  border-radius:10px;
  background:#1c1c1c;
  border:2px dashed rgba(255,255,255,.35);
  display:flex;
  flex-direction:column;
  justify-content:center;
  text-align:center;
  opacity:.45;
  transition:.2s;
  overflow:hidden;
}

.slot.hover{
  border-color:#0af;
  box-shadow:0 0 15px rgba(0,170,255,.6);
}

.slot.filled{
  border-style:solid;
  opacity:1;
  cursor:grab;
}

.slot img{
  width:100%;
  height:58%;
  object-fit:cover;
}

.slot-name{
  font-size:.5rem;
  padding:2px;
  line-height:1.05;
}

.slot small{
  font-size:.4rem;
  opacity:.6;
}
</style>
    <link rel="stylesheet" href="mobile.css">
</head>

<body>


<h1>Build the Lineup</h1>

<div class="navLinks"></div>
<br><br>

<div class="mode-toggle">
  <div class="select-wrap">
<select class="dropdown" data-role="single"></select>
  </div>
</div>

<!-- ACTIVE CARD -->
<div id="cardMount"></div>

<!-- FIELD -->
<div class="field">
  <div class="field-grid">
    <div class="slot" data-pos="WR1" style="grid-column:1;">WR1</div>
    <div class="slot" data-pos="FLEX" style="grid-column:3;">FLEX</div>

    <div class="slot" data-pos="LT" style="grid-column:5;">LT</div>
    <div class="slot" data-pos="LG" style="grid-column:6;">LG</div>
    <div class="slot" data-pos="C"  style="grid-column:7;">C</div>
    <div class="slot" data-pos="RG" style="grid-column:8;">RG</div>
    <div class="slot" data-pos="RT" style="grid-column:9;">RT</div>

    <div class="slot" data-pos="TE" style="grid-column:10;">TE</div>
    <div class="slot" data-pos="WR2" style="grid-column:11;">WR2</div>

    <div class="slot" data-pos="QB" style="grid-column:7;grid-row:2;">QB</div>
    <div class="slot" data-pos="RB" style="grid-column:7;grid-row:3;">RB</div>
  </div>
</div>

<div id="helpWrapper">
  <button id="helpBtn">?</button>
  <div id="helpTooltip">
    <strong>How to Play</strong><br><br>
    ‚Ä¢ Drag each person onto the field<br>
    ‚Ä¢ Fill all positions to complete the lineup<br>
    ‚Ä¢ You can move players between slots
  </div>
</div>
<script src="default.js"></script>
<script>
/* ================= STATE ================= */
let pool = [];
let current = null;
let activeCard = null;
let filledCount = 0;
let sourceSlot = null;


const MAX_PLAYERS = 11;

/* ================= RESET ================= */
function resetGameState(){
  pool = [];
  current = null;
  activeCard = null;
  filledCount = 0;

  const cardMount = document.getElementById("cardMount");
  if (cardMount) cardMount.innerHTML = "";

  document.querySelectorAll(".slot").forEach(slot=>{
    slot.classList.remove("filled", "hover");
    slot.innerHTML = slot.dataset.pos;
    slot.player = null;
    slot.draggable = false;
  });
}

/* ================= START ================= */
function startGame(){
  const cardMount = document.getElementById("cardMount");
  if (!cardMount) return;

  pool = Object.entries(getPeople(gender))
    .map(([name, img]) => ({ name, img }))
    .sort(() => Math.random() - 0.5);

  spawnNextCard();
}

/* ================= CARD ================= */
function createCard(player){
  const card = document.createElement("div");
  card.className = "card center";
  card.draggable = true;
  card.player = player;

  card.innerHTML = `
    ${player.img ? `<img src="${player.img}">` : ""}
    <p>${player.name}</p>
  `;

  card.addEventListener("dragstart", () => {
    activeCard = card;
  });

  return card;
}

function spawnNextCard(){
  const cardMount = document.getElementById("cardMount");
  if (!cardMount) return;

  if (filledCount >= MAX_PLAYERS || pool.length === 0){
    endGame();
    return;
  }

  current = pool.pop();

  if (activeCard) activeCard.remove();
  activeCard = createCard(current);
  cardMount.appendChild(activeCard);
}

/* ================= SLOTS ================= */
document.querySelectorAll(".slot").forEach(slot=>{
  slot.addEventListener("dragover", e=>{
    if (slot.classList.contains("filled")) return;
    e.preventDefault();
    slot.classList.add("hover");
  });

  slot.addEventListener("dragleave", ()=>{
    slot.classList.remove("hover");
  });

slot.addEventListener("drop", e=>{
  e.preventDefault();
  slot.classList.remove("hover");

  if (!activeCard || slot.classList.contains("filled")) return;

  // Moving from another slot
  if (sourceSlot && sourceSlot !== slot){
    fillSlot(slot, sourceSlot.player);
    clearSlot(sourceSlot);
    sourceSlot = null;
    activeCard = null;
    return;
  }

  // Dropping from cardMount
  fillSlot(slot, activeCard.player);
  filledCount++;
  activeCard.remove();
  activeCard = null;
  spawnNextCard();
});


slot.addEventListener("dragstart", ()=>{
  if (!slot.classList.contains("filled")) return;
  activeCard = slot;
  sourceSlot = slot;
});

});


function clearSlot(slot){
  slot.classList.remove("filled");
  slot.player = null;
  slot.draggable = false;
  slot.innerHTML = slot.dataset.pos;
}


/* ================= SLOT FILL ================= */
function fillSlot(slot, player){
  slot.classList.add("filled");
  slot.player = player;
  slot.draggable = true;

  slot.innerHTML = `
    ${player.img ? `<img src="${player.img}">` : ""}
    <div class="slot-name">
      <small>${slot.dataset.pos}</small><br>
      ${player.name}
    </div>
  `;
}

/* ================= END ================= */
function endGame(){
  const cardMount = document.getElementById("cardMount");
  if (cardMount){
    cardMount.innerHTML = "<h2>üèà Lineup Complete!</h2>";
  }
}

/* ================= INIT ================= */
loadPeopleData(startGame);

document.getElementById("helpBtn").onclick = () => {
  const tooltip = document.getElementById("helpTooltip");
  tooltip.style.display = tooltip.style.display === "block" ? "none" : "block";
};
</script>

</body>
</html>
